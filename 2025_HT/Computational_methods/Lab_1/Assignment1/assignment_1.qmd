---
title: "Computational Methods"
subtitle: "Assignment 1"
author: "Rasmus Hammar"
format: typst
---

## Imports

```{python}
import numpy as np
import matplotlib.pyplot as plt
```

## Problem

Solve for the currents in the following circuit:

![Electrical system](Electrical_system.png){#fig-system fig-align="center"}

## Variables

For solving the equation system:

$$
\left(\begin{align*}
6I_2 - 2I_3 &= 10 \\
4I_2 + I_3 + 2I_4 + 2I_5 &= 17 \\ 
2I_5 + 4I_6 &= 14 \\
I_1 - I_2 + I_4 &= 0 \\
I_3 - I_5 + I_6 &= 0 \\
I_4 - I_5 + I_6 &= 0
\end{align*}\right)
$$

Matrices `circuit` and `voltages` are created.

```{python}
circuit = np.array(
    [
        [0, 6, -2, 0, 0, 0],
        [0, 4, 1, 2, 2, 0],
        [0, 0, 0, 0, 2, 4],
        [1, -1, 0, 1, 0, 0],
        [0, 0, 1, 0, -1, 1],
        [0, 0, 0, 1, -1, 1],
    ]
)
voltages = np.array([10, 100, 14, 0, 0, 0])
```

Inspecting the matrices:

```{python}
# | echo: false
print("Circuit matrix:\n", circuit)
print("Shape:", circuit.shape)
print("Dimensions:", circuit.ndim)
print("------------------------------")
print("Voltages matrix:\n", voltages)
print("Shape:", voltages.shape)
print("Dimensions:", voltages.ndim)
```

## Solution

```{python}
currents = np.linalg.solve(circuit, voltages)
```

Currents are:

```{python}
# | fig-cap: "Theoretically estimated currents based on system in @fig-system."
# | fig-align: center
x_axis = ["$I_1$", "$I_2$", "$I_3$", "$I_4$", "$I_5$", "$I_6$"]
plt.figure(1)
plt.bar(x_axis, currents, color="blue")
plt.ylabel("Current [A]")
plt.title("Currents $I_1$-$I_6$ in the circuit")
plt.show()
```
