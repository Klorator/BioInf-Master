---
title: "Lab 3"
subtitle: "Knowledge-Based Systems in Bioinformatics"
author: "Rasmus Hammar"
format: typst
---

## Task 1

A = (U,A ∪ {d})

```{r}
info_TA <- c(
  -(4 / 9) * log2(4 / 9) - (5 / 9) * log2(5 / 9)
)
```

Info([4,5]) = `r info_TA` bits.

Table 1. Decision system A discretized using equal frequency with three levels.

|index| Cuts feature_1 | decision  |
|-----|-----------|-----------|
|x~6~| [91, 105) | No        |
|x~7~| [91, 105) | No        |
|x~1~| [91, 105) | No        |
|x~9~| [45, 91)  | No        |
|x~8~| [45, 91)  | Yes       |
|x~2~| [45, 91)  | No        |
|x~4~| [21, 45)  | Yes       |
|x~3~| [21, 45)  | Yes       |
|x~5~| [21, 45)  | Yes       |

POS~feature_1~({d}) = {{x~1~, x~6~, x~7~}, {x~3~, x~4~, x~5~}} $=> \gamma = \frac{6}{9}$


Calculate bits.

```{r}
info_T1 <- c(
  -(0 / 3) * log2(0 / 3) - (3 / 3) * log2(3 / 3),
  -(1 / 3) * log2(1 / 3) - (2 / 3) * log2(2 / 3),
  -(3 / 3) * log2(3 / 3) - (0 / 3) * log2(0 / 3)
)
info_T1[1] <- 0 # defined as 0 bits
info_T1[3] <- 0 # defined as 0 bits
info_T1 <- sum(info_T1 * c(3 / 9, 3 / 9, 3 / 9))
```

Info([0,3],[1,2],[3,0]) = `r info_T1` bits.

Gain(feature_1) = info([4,5]) - info([0,3],[1,2],[3,0]) = `r info_TA - info_T1` bits.

Gain_ratio(feature_1) = gain(feature_1) / split_info(feature_1) 

Table 2. Decision system A discretized using naive method.

|index| Cuts feature_1 | decision |
|-----|-----------|----------|
|x~6~| [77.5, 105) | No       |
|x~7~| [77.5, 105) | No       |
|x~1~| [77.5, 105) | No       |
|x~9~| [77.5, 105) | No       |
|x~8~| [61.5, 77.5)  | Yes      |
|x~2~| [45, 61.5)  | No       |
|x~4~| [21, 45)  | Yes      |
|x~3~| [21, 45)  | Yes      |
|x~5~| [21, 45)  | Yes      |

POS~feature_1~({d}) = {{x~1~, x~6~, x~7~, x~9~}, {x~8~}, {x~2~}, {x~3~, x~4~, x~5~}} $=> \gamma = \frac{9}{9} = 1$

Comparing $\gamma = \frac{6}{9}$ and $\gamma = \frac{9}{9} = 1$, the naive method would be better, but the equal frequency method is probably good enough and more generalizable.

Calculate bits.

```{r}
info_T2 <- c(
  -(0 / 4) * log2(0 / 4) - (4 / 4) * log2(4 / 4),
  -(1 / 1) * log2(1 / 1) - (0 / 1) * log2(0 / 1),
  -(0 / 1) * log2(0 / 1) - (1 / 1) * log2(1 / 1),
  -(3 / 3) * log2(3 / 3) - (0 / 3) * log2(0 / 3)
)
info_T2 <- c(0, 0, 0, 0) # defined as 0 bits
info_T2 <- sum(info_T2 * c(4 / 9, 1 / 9, 1 / 9, 3 / 9))
```

Info([0,3],[1,2],[3,0]) = `r info_T2` bits.

Gain = info([4,5]) - info([0,3],[1,2],[3,0]) = `r info_TA - info_T2` bits.

B = (U,B ∪ {d})

Table 3. Decision system A discretized using equal frequency with three levels.

| Cuts         | decision |
|--------------|----------|
| [0.67, 0.97) | {A, B}   |
| [0.29, 0.67) | {A, B}   |
| [0.04, 0.29) | {A, B}   |

Table 4. Decision system A discretized using naive method.

| Cuts         | decision  |
|--------------|-----------|
| [0.89, 0.97) | A         |
| [0.75, 0.89) | B         |
| [0.39, 0.75) | A         |
| [0.17, 0.39) | B         |
| [0.08, 0.17) | A         |
| [0.03, 0.08) | B         |



## Task 2